import vulners


'''cve_id_info = vulners_api.document(cve_id)
print(cve_id_info.get('title'))
enchantments = cve_id_info.get('enchantments')
dependencies = enchantments.get('dependencies')
references = dependencies.get('references')
exploitdb_references = list(filter(lambda item: item['type'] == 'exploitdb', references))
print(exploitdb_references[0].get('idList'))'''

def exploit_id(cve_id):
    vulners_api = vulners.Vulners(api_key=API Key)
    cve_id_info = vulners_api.document(cve_id)
    enchantments = cve_id_info.get('enchantments')
    dependencies = enchantments.get('dependencies')
    references = dependencies.get('references')
    exploitdb_references = list(filter(lambda item: item['type'] == 'exploitdb', references))
    exdb_id = exploitdb_references[0].get('idList')
    new_exdb_id = [id.replace('EDB-ID:','https://www.exploit-db.com/exploits/') for id in exdb_id]
    print(new_exdb_id)
    return new_exdb_id

# cve_ID = input("Input CVE ID:")
# exploit_id(cve_ID)
