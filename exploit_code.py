import requests
import urllib3
from bs4 import BeautifulSoup
from exploit_link import *
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def exploit_code(cve_id):
    new_exdb_id = exploit_id(cve_id)
    print(new_exdb_id)
    for URL in new_exdb_id:
        headers = {'User-Agent': 'Mozilla/5.0'}
        page = requests.get(URL, headers=headers, verify=False)
        soup = BeautifulSoup(page.content, "html.parser")
        results = soup.find("code")
        return results


# new_exdb_id = exploit_id(input('Input CVE ID:'))
# print(new_exdb_id)
# for URL in new_exdb_id:
#     headers = {'User-Agent': 'Mozilla/5.0'}
#     page = requests.get(URL, headers=headers, verify=False)
#     soup = BeautifulSoup(page.content, "html.parser")
#     results = soup.find("code")
#     print(results)

'''
URL = "https://www.exploit-db.com/exploits/16686"
headers = {'User-Agent': 'Mozilla/5.0'}
page = requests.get(URL, headers=headers, verify=False)
soup = BeautifulSoup(page.content, "html.parser")
results = soup.find_all("code", class_="language-rb")
print(results)
'''
